<div class="edit-fidelity-section">
    <h2>Modifier la Fidélité #{{ fidelite?.id }}</h2>
  
    <!-- Error Message -->
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
      <button class="clear-error-btn" (click)="clearError()">OK</button>
    </div>
  
    <!-- Loading Spinner -->
    <div *ngIf="isLoadingFidelity || isLoadingUsers" class="loading">
      Chargement...
    </div>
  
    <!-- Form -->
    <form *ngIf="!isLoadingFidelity && !isLoadingUsers && fidelite" (ngSubmit)="onSubmit()" class="fidelite-form">
      <div class="form-group">
        <label for="user">Utilisateur</label>
        <select
          id="user"
          [(ngModel)]="selectedUserId"
          name="user"
          (change)="clearError()"
          required
        >
          <option [ngValue]="null" disabled>Sélectionner un utilisateur</option>
          <option *ngFor="let user of users" [ngValue]="user.id">
            {{ user.nom }} {{ user.prenom }} (ID: {{ user.id }})
          </option>
        </select>
      </div>
  
      <div class="form-group">
        <label for="points">Points</label>
        <input
          type="number"
          id="points"
          [(ngModel)]="fidelite.points"
          name="points"
          min="0"
          (input)="clearError()"
          required
        />
      </div>
  
      <div class="form-group">
        <label for="niveau">Niveau</label>
        <select
          id="niveau"
          [(ngModel)]="fidelite.niveau"
          name="niveau"
          (change)="clearError()"
          required
        >
          <option value="Bronze">Bronze</option>
          <option value="Argent">Argent</option>
          <option value="Or">Or</option>
          <option value="Platine">Platine</option>
        </select>
      </div>
  
      <div class="form-actions">
        <button type="submit" class="submit-btn" [disabled]="selectedUserId === null || fidelite.points === null || fidelite.points < 0">Mettre à jour</button>
        <button type="button" class="cancel-btn" (click)="goBack()">Annuler</button>
      </div>
    </form>
  </div>